<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zagadka ZHR ‚Äî Morse ‚Üí GA-DE-RY-PO-LU-KI</title>
  <style>
    :root{
      --bg1:#1e3c72; --bg2:#2a5298;
      --card-bg: rgba(255,255,255,0.08);
      --glass-blur: 12px;
      --text:#ffffff; --muted:#d0d6f5;
      --accent1:#6c8cff; --accent2:#4a6ee0;
      --ok:#2ecc71; --err:#ff5c7a;
      --mono:#aee1ff;
    }
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Segoe UI', Roboto, system-ui, -apple-system, Arial, sans-serif;
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      color:var(--text);
      display:flex; align-items:center; justify-content:center;
      min-height:100vh; padding:20px;
    }
    .card{
      width:100%; max-width:960px;
      background:var(--card-bg);
      backdrop-filter: blur(var(--glass-blur));
      border-radius:20px;
      padding:32px;
      box-shadow:0 10px 40px rgba(0,0,0,.4);
      animation:fadeIn .8s ease both;
      text-align:center;
    }
    @keyframes fadeIn{
      from{opacity:0; transform:translateY(14px)}
      to{opacity:1; transform:translateY(0)}
    }
    h1{margin:0 0 6px; font-size:28px; letter-spacing:.4px}
    p.lead{margin:0; color:var(--muted)}
    pre{
      background: rgba(0,0,0,.4);
      padding:16px; border-radius:12px;
      margin:20px 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size:16px; line-height:1.6; color:var(--mono);
      text-align:left; overflow-x:auto;
    }
    .controls{display:flex; gap:10px; justify-content:center; align-items:center; flex-wrap:wrap}
    input{
      padding:12px 14px; border-radius:10px; border:1px solid rgba(255,255,255,.25);
      background: rgba(255,255,255,.12); color:#fff; width:220px; font-size:16px; outline:none;
      transition: box-shadow .15s ease, border-color .15s ease;
    }
    input:focus{box-shadow:0 0 0 4px rgba(108,140,255,.25); border-color:#a1b4ff}
    button{
      padding:12px 20px; border:none; border-radius:10px;
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      color:#fff; font-weight:700; letter-spacing:.2px; cursor:pointer;
      transition: transform .12s ease, box-shadow .15s ease, filter .2s ease;
    }
    button:hover{transform:translateY(-2px); box-shadow:0 8px 18px rgba(0,0,0,.3)}
    button:active{transform:translateY(0)}
    .msg{margin-top:12px; font-weight:700}
    .ok{color:var(--ok)} .no{color:var(--err)}
    #qrSection{margin-top:24px; display:none}
    .qrbox{
      display:inline-grid; place-items:center;
      padding:14px; background:#ffffff; border-radius:14px;
      box-shadow:0 8px 24px rgba(0,0,0,.35);
      margin:0 auto 12px;
    }
    #qrcode canvas, #qrcode img{width:200px !important; height:200px !important}
    .note{color:#fff; font-style:italic}
    .hint{margin-top:8px; color:var(--muted); font-size:14px}
  </style>
</head>
<body>
  <main class="card" role="main" aria-labelledby="t">
    <h1 id="t">üîê Zaszyfrowane pytanie</h1>
    <p class="lead">Najpierw odszyfruj Morse‚Äôa (litery = ‚Äû/‚Äù, s≈Çowa = ‚Äû//‚Äù), potem u≈ºyj szyfru GA-DE-RY-PO-LU-KI.</p>

    <pre id="cipher" aria-label="Tekst zagadki w alfabecie Morse‚Äôa"></pre>
    <div class="hint">Uwaga: polskie znaki sƒÖ bez ogonk√≥w, znak ‚Äû?‚Äù jest wspierany w Morse‚Äôie.</div>

    <div class="controls" aria-label="Wprowad≈∫ odpowied≈∫">
      <input id="odpowiedz" type="text" placeholder="Twoja odpowied≈∫‚Ä¶" inputmode="numeric" aria-label="Odpowied≈∫" />
      <button id="sprawdz">Sprawd≈∫</button>
    </div>
    <div class="msg" id="komunikat" role="status" aria-live="polite"></div>

    <section id="qrSection" aria-label="Sekcja z kodem QR">
      <div class="qrbox">
        <div id="qrcode" aria-hidden="false"></div>
      </div>
      <p class="note">üì∏ Link do zdjƒôƒá znajdziesz w starym po≈õcie z pielgrzymki ZHR.</p>
    </section>
  </main>

  <!-- Biblioteka QRCodeJS (musi byƒá za≈Çadowana przed u≈ºyciem) -->
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
  <script>
    // ===== KONFIG =====
    const PYTANIE_ORG = "Kt√≥ra to by≈Ça pielgrzymka ZHR?";
    const POPRAWNE = ["43"];
    const MSG_OK = "Brawo! To poprawna odpowied≈∫ üéâ";
    const MSG_NO = "Nie tym razem. Spr√≥buj jeszcze raz.";
    const QR_TRESC = "https://twoj-link-do-zdjec.pl"; // <- PODMIE≈É na w≈Ça≈õciwy link

    // ===== SZYFROWANIE =====
    const stripDiacritics = s => s.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    const GADERY = { G:"A", A:"G", D:"E", E:"D", R:"Y", Y:"R", P:"O", O:"P", L:"U", U:"L", K:"I", I:"K" };
    const applyGadery = s => s.split("").map(ch=>{
      const up = ch.toUpperCase();
      if (GADERY[up]) {
        const mapped = GADERY[up];
        return (ch === ch.toUpperCase()) ? mapped : mapped.toLowerCase();
      }
      return ch;
    }).join("");

    const MORSE = {
      "A":".-","B":"-...","C":"-.-.","D":"-..","E":".","F":"..-.","G":"--.","H":"....","I":"..","J":".---",
      "K":"-.-","L":".-..","M":"--","N":"-.","O":"---","P":".--.","Q":"--.-","R":".-.","S":"...","T":"-",
      "U":"..-","V":"...-","W":".--","X":"-..-","Y":"-.--","Z":"--..",
      "0":"-----","1":".----","2":"..---","3":"...--","4":"....-","5":".....",
      "6":"-....","7":"--...","8":"---..","9":"----.",
      "?":"..--.."
    };

    // Morse: litery "/" , s≈Çowa "//"
    const toMorse = s => {
      return s.split(" ").map(word =>
        word.split("").map(ch => {
          const up = ch.toUpperCase();
          return MORSE[up] || "";
        }).filter(Boolean).join(" / ")
      ).join(" // ");
    };

    // Kolejno≈õƒá dla u≈ºytkownika: Morse -> GA-DE-RY-PO-LU-KI,
    // wiƒôc tutaj najpierw kodujemy GA-DE-RY-PO-LU-KI, potem zamieniamy na Morse‚Äôa.
    const pytanieBase = stripDiacritics(PYTANIE_ORG);
    const poGadery = applyGadery(pytanieBase);
    const morseFinal = toMorse(poGadery);
    document.getElementById("cipher").textContent = morseFinal;

    // ===== LOGIKA ODP. + QR =====
    const input = document.getElementById("odpowiedz");
    const msg = document.getElementById("komunikat");
    const qrSection = document.getElementById("qrSection");
    const qrContainer = document.getElementById("qrcode");

    function showQR() {
      // wyczy≈õƒá poprzedniƒÖ zawarto≈õƒá (gdyby u≈ºytkownik od≈õwie≈ºa≈Ç/klika≈Ç kilka razy)
      qrContainer.innerHTML = "";
      new QRCode(qrContainer, {
        text: QR_TRESC,
        width: 200,
        height: 200,
        colorDark: "#000000",
        colorLight: "#ffffff",
        correctLevel: QRCode.CorrectLevel.H
      });
      qrSection.style.display = "block";
    }

    function checkAnswer() {
      const val = (input.value || "").trim().replace(",", ".");
      const ok = POPRAWNE.includes(val);
      msg.textContent = ok ? MSG_OK : MSG_NO;
      msg.className = "msg " + (ok ? "ok" : "no");
      if (ok) showQR();
    }

    document.getElementById("sprawdz").addEventListener("click", checkAnswer);
    input.addEventListener("keydown", e => { if (e.key === "Enter") checkAnswer(); });
  </script>
</body>
</html>
